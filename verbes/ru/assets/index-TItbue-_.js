(function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))f(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const p of i.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&f(p)}).observe(document,{childList:!0,subtree:!0});function m(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function f(o){if(o.ep)return;o.ep=!0;const i=m(o);fetch(o.href,i)}})();document.addEventListener("DOMContentLoaded",()=>{const y=document.getElementById("page-title"),u=document.getElementById("page-description"),m=document.getElementById("verb-groups-container"),f=document.getElementById("top-verbs-list"),o=document.getElementById("total-patterns"),i=document.getElementById("most-common-pattern"),p=document.getElementById("most-irregular"),v=document.getElementById("easiest-to-learn"),_=document.getElementById("summary-notes"),b=document.getElementById("verb-search"),d=document.getElementById("search-results"),g=document.getElementById("search-results-list");let h=[];function L(e){if(e.length<3){d.classList.add("hidden"),g.innerHTML="";return}const s=e.toLowerCase().trim(),n=h.filter(t=>{if(t.infinitive.toLowerCase().startsWith(s))return!0;if(t.verbes_du_type){const a=t.verbes_du_type.toLowerCase().split(",").map(c=>c.trim()).filter(c=>c.length>0).find(c=>c.startsWith(s));if(a)return t.matched_verb=a,!0}return!1});if(n.length===0){d.classList.add("hidden"),g.innerHTML="";return}d.classList.remove("hidden"),g.innerHTML=n.map(t=>`
            <li class="p-2 hover:bg-gray-100 cursor-pointer" data-infinitive="${t.infinitive}">
                <strong>${t.infinitive}</strong>
                ${t.matched_verb?`<span class="text-sm text-blue-500 italic">(trouvé: <span class="font-bold">${t.matched_verb}</span>)</span>`:""}
            </li>
        `).join(""),g.querySelectorAll("li").forEach(t=>{t.addEventListener("click",r=>{const a=r.currentTarget.dataset.infinitive,c=E(a),l=c.querySelector(`#${a}`);if(c){const x=c.closest(".group-box").querySelector("[aria-expanded]");x.getAttribute("aria-expanded")==="false"&&x.click(),l&&l.scrollIntoView({behavior:"smooth",block:"center"})}d.classList.add("hidden")})})}function E(e){const s=document.querySelectorAll(".group-box");for(const n of s){const t=n.querySelectorAll("h3");for(const r of t)if(r&&r.textContent===e)return n}return null}b.addEventListener("input",e=>{L(e.target.value)}),document.addEventListener("click",e=>{!d.contains(e.target)&&!b.contains(e.target)&&d.classList.add("hidden")});function w(e){h=[];for(const s in e.conjugation_groups){const n=e.conjugation_groups[s];h.push(...n.verbs)}}function $(e){const s=new Set;if(!e||!e.conjugation_groups||typeof e.conjugation_groups!="object")return console.warn("Warning: 'conjugation_groups' not found or not an object in the JSON data."),[];for(const n in e.conjugation_groups)if(Object.prototype.hasOwnProperty.call(e.conjugation_groups,n)){const t=e.conjugation_groups[n];t&&t.verbs&&Array.isArray(t.verbs)?t.verbs.forEach(r=>{if(r&&r.infinitive&&typeof r.infinitive=="string"&&s.add(r.infinitive.trim()),r&&r.verbes_du_type&&typeof r.verbes_du_type=="string"){const a=r.verbes_du_type.trim();a.length>0&&a.split(",").map(l=>l.trim()).filter(l=>l.length>0).forEach(l=>{s.add(l)})}}):console.warn(`Warning: Verbs array missing or malformed in group '${n}'.`)}return s.size}async function C(){try{const s=await(await fetch("assets/french_verbes_3m-gr.json")).json();s.metadata.total_verbs=$(s),j(s)}catch(e){console.error("Erreur lors du chargement des données :",e),m.innerHTML='<p class="text-red-600 text-center text-xl">Erreur lors du chargement des données</p>'}}function j(e){y.textContent=e.metadata.title,u.textContent=e.metadata.description+`: (total ${e.metadata.total_verbs} verbes )`,w(e);for(const n in e.conjugation_groups){const t=e.conjugation_groups[n],r=I(t);m.appendChild(r)}e.frequency_analysis.top_10_most_frequent.forEach(n=>{const t=document.createElement("li");t.className="flex items-center space-x-2 text-gray-700",t.innerHTML=`
                <span class="font-semibold text-indigo-700">${n.rank}. ${n.infinitive}</span>
                <!--<span class="text-gray-500">(${n.translation})</span>-->
                <span class="text-sm text-gray-400">— ${n.frequency_note}</span>
            `,f.appendChild(t)});const s=e.conjugation_patterns_summary;o.innerHTML=`<span class="font-semibold">Nombre total de modèles :</span> ${s.total_patterns}`,i.innerHTML=`<span class="font-semibold">Le plus courant :</span> ${s.most_common_pattern}`,p.innerHTML=`<span class="font-semibold">Les plus irréguliers :</span> ${s.most_irregular}`,v.innerHTML=`<span class="font-semibold">Les plus faciles à apprendre :</span> ${s.easiest_to_learn}`,s.notes.forEach(n=>{const t=document.createElement("li");t.textContent=n,t.className="text-gray-700",_.appendChild(t)})}function I(e){const s=document.createElement("div");s.className="group-box bg-gradient-to-r from-indigo-600 to-purple-600 text-white cursor-pointer rounded-xl shadow-lg border border-gray-200 overflow-x-hidden";const n=document.createElement("div");n.className="w-full p-4 text-left flex justify-between items-center text-white font-bold text-xl rounded-xl transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-75",n.setAttribute("aria-expanded","false"),n.setAttribute("aria-controls",`content-${e.name.replace(/\s+/g,"-")}`),n.innerHTML=`
            <div>
                <h2 class="md:text-2xl text-sm">${e.name}</h2>
                <p class="text-base font-normal opacity-90">${e.pattern}</p>
                <span class="text-sm font-normal opacity-80">${e.verbs.length} verbes</span>
            </div>
            <svg class="w-6 h-6 transform transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
        `;const t=document.createElement("div");return t.id=`content-${e.name.replace(/\s+/g,"-")}`,t.className="max-h-0 opacity-0 overflow-x-hidden transition-all duration-500 ease-in-out",e.verbs.forEach(r=>{const a=B(r);t.appendChild(a)}),n.addEventListener("click",()=>{const r=n.getAttribute("aria-expanded")==="true";n.setAttribute("aria-expanded",!r),n.querySelector("svg").classList.toggle("rotate-180",!r),r?(t.classList.remove("max-h-none","opacity-100"),t.classList.add("max-h-0","opacity-0"),t.style.padding="0"):(t.classList.remove("max-h-0","opacity-0"),t.classList.add("max-h-none","opacity-100"),t.style.padding="1rem")}),s.appendChild(n),s.appendChild(t),s}function B(e){const s=document.createElement("div");return s.id=e.infinitive,s.className="grid gap-2 bg-white rounded-lg p-4 shadow-sm border border-gray-100 mb-4 last:mb-0",s.setAttribute("data-infinitive",e.infinitive),s.innerHTML=`
            <div class="flex justify-between items-start">
                <h3 class="text-lg font-semibold text-gray-800 pr-2">${e.infinitive}</h3>
                <span class="text-sm text-gray-500">${e.verbes_du_type||""}</span>
            </div>
            <div>
            <span class="text-sm text-blue-600 font-bold">${e.translation||""}</span>
            </div>
            <div>
            <span class="text-sm text-blue-800">${e.justification||""}</span>
            </div>
            <div class="space-y-2">
                    <h4 class="text-sm md:text-base font-medium text-gray-600">Présent</h4>
                    <div class="grid grid-rows-3 grid-cols-2 md:grid-cols-3 gap-2 grid-flow-col">
                        ${Object.entries(e.present_tense).map(([n,t])=>`
                            <div class="text-sm md:text-base text-gray-700 flex items-start">
                                <div class="font-medium min-w-14">${n}<span>:</span></div>
                                <div class="ml-1 text-blue-900 font-bold">${t}</div>
                            </div>
                        `).join("")}
                    </div>
            </div>
        `,s}C()});
